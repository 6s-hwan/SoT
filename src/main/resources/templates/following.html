<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" th:href="@{/css/following.css}" />
  <link rel="stylesheet" th:href="@{/css/Home.css}" />
  <link
          rel="stylesheet"
          type="text/css"
          href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css"
  />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
          href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap"
          rel="stylesheet"
  />
  <title>SoT</title>
</head>
<body>
<nav class="navbar">
  <div class="nav_logo">
    <div id="nav_left">
      <div id="nav_logo1">
        <a href="./test">
          <img th:src="@{/images/MainLogo.png}" alt="로고" width="200px" height="46px">
        </a>
      </div>
      <div class="nav_menu">
        <ul class="navigation">
          <li><a href="./test" class="b">홈</a></li>
          <li><a href="" class="c">지역</a></li>
          <li><a href="" class="c">북마크</a></li>
        </ul>
      </div>
      <form action="/search" method="get" id="search">
        <input type="text" name="query" class="search">
        <img th:src="@{/images/search.png}" alt="돋보기" width="30px" height="30px">
      </form>
    </div>
    <div id="nav_right">
      <input type="button" id="uploadbtn">
      <input type="button" class="imagebtn" onclick="location.href='my-page'">
      <input type="checkbox" id="join" style="display: none;">
      <label for="join" id="loginLabel" onclick="togglePopup('loginPopup')">로그인</label>
      <form action="/logout" method="post" style="display:inline;">
        <button type="submit">로그아웃</button>
      </form>
    </div>
  </div>
</nav>

<!-- 팝업창들 -->
<div th:replace="fragments/upload_popup :: uploadPopup"></div>
<div th:replace="fragments/login_popup :: loginPopup"></div>
<div th:replace="fragments/join_popup :: joinPopup"></div>
<div th:replace="fragments/terms_popup :: termsPopup"></div>
<div th:replace="fragments/privacy_popup :: privacyPopup"></div>

<!-- 팔로잉 페이지 시작 -->
<div id="followingfull">
  <div id="following">
    <div id="followingTitle">
      <div id="followingtitletext">
        <img
                th:src="@{/images/followingicon.png}"
                class="followingimg"
                width="52px"
                height="46px"
        />
        <p class="followingtitle1">팔로잉</p>
      </div>
    </div>
    <ul class="following-list">
      <li class="following-item" th:each="follow : ${followsInfos}">
        <div class="profile-container">
          <a th:href="@{'/writer/' + ${follow.username}}">
            <img th:src="${follow.profileImageUrl}" alt="프로필 이미지" class="profile-img"/>
          </a>
          <p class="username" th:text="${follow.username}">Username</p>
          <p class="follower-count" th:text="'팔로워 수: ' + ${follow.followerCount}">Follower Count</p>
          <p class="story-count" th:text="'게시글 수: ' + ${follow.totalStories}">Story Count</p>
          <p class="like-count" th:text="'총 좋아요 수: ' + ${follow.totalLikes}">Total Likes</p>
          <p class="last-upload" th:text="'최근 업로드: ' + ${follow.lastUploadDate}">Last Upload</p>
          <!-- 주요 테마를 2개로 표시 -->
          <p class="top-theme" th:text="'주요 테마: ' + ${follow.topThemes}">Top Themes</p>
        </div>

        <!-- 최근 스토리 8개로 확장 -->
        <div class="recent-stories">
          <p>최근 스토리</p>
          <ul class="story-list">
            <li th:each="story : ${follow.recentStories}">
              <a th:href="@{'/story/' + ${story.storyId}}">
                <img th:src="${story.image_url}" alt="스토리 이미지" class="story-img" width="100" height="100"/>
              </a>
            </li>
          </ul>
        </div>

        <!-- 팔로우 여부 표시 및 팔로우 취소 버튼 추가 -->
        <div class="follow-status">
          <p th:text="${follow.isFollowing} ? '팔로우 중' : '팔로우 안함'">Following Status</p>

          <form th:action="@{'/writer/' + ${follow.username} + '/unfollow'}" method="post">
            <button type="submit">팔로우 취소</button>
          </form>
        </div>
      </li>
    </ul>
  </div>
</div>
<!-- 팔로잉 페이지 끝 -->

<script th:src="@{/js/Home.js}"></script>
</body>
</html>
